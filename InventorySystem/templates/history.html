<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-light">

<div class="d-flex">
    <div class="bg-dark text-white p-3" style="width: 250px; min-height: 100vh;">
        <h4>ðŸ“¦ Inventory</h4>
        <small>Admin System</small>
        <hr>
        <nav class="nav flex-column gap-2">
            <a href="{{ url_for('index') }}" class="text-secondary text-decoration-none p-2"><i class="fas fa-box me-2"></i> Products</a>
            <a href="{{ url_for('customers') }}" class="text-secondary text-decoration-none p-2"><i class="fas fa-users me-2"></i> Customers</a>
            <a href="{{ url_for('suppliers') }}" class="text-secondary text-decoration-none p-2"><i class="fas fa-truck me-2"></i> Suppliers</a>
            <a href="{{ url_for('history') }}" class="text-white text-decoration-none p-2 bg-primary rounded"><i class="fas fa-history me-2"></i> History Log</a>
        </nav>
    </div>

    <div class="flex-grow-1 p-4">
        <h2>ðŸ“œ Transaction History</h2>
        
        <div class="card shadow-sm border-0 mt-4">
            <table class="table table-hover mb-0 align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Date/Time</th>
                        <th>User</th>
                        <th>SKU</th>
                        <th>Product Name</th>
                        <th>Party</th> <th class="text-center">Type</th>
                        <th class="text-end pe-4">Quantity</th>
                        <th class="text-center">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in transactions %}
                    <tr>
                        <td class="text-muted small">{{ t.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                        <td><span class="badge bg-secondary">{{ t.user_name }}</span></td>
                        <td>{{ t.sku }}</td>
                        <td class="fw-bold">{{ t.product_name }}</td>
                        <td>{{ t.party_name }}</td> <td class="text-center">
                            {% if t.transaction_type == 'IN' %}
                                <span class="badge bg-success" style="width: 60px;">IN</span>
                            {% else %}
                                <span class="badge bg-danger" style="width: 60px;">OUT</span>
                            {% endif %}
                        </td>
                        <td class="text-end pe-4 fw-bold text-dark">
                            {{ '+' if t.transaction_type == 'IN' else '-' }}{{ t.quantity }}
                        </td>
                        <td class="text-center">
                             {% if t.transaction_type == 'OUT' %}
                            <a href="{{ url_for('print_invoice', transaction_id=t.id) }}" target="_blank" class="btn btn-sm btn-secondary" title="Print Invoice">
                                <i class="fas fa-print"></i>
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                    {% else %}
                    <tr><td colspan="8" class="text-center py-4">No history found.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>